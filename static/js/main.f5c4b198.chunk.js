(this["webpackJsonpuchi-test"]=this["webpackJsonpuchi-test"]||[]).push([[0],{36:function(t,e,c){},37:function(t,e,c){},62:function(t,e,c){"use strict";c.r(e);var n=c(0),a=c.n(n),i=c(29),r=c.n(i),s=(c(36),c(37),c(9)),o=Object(n.createContext)(),u=Object(n.createContext)(),l=c(1),j=function(){var t=Object(n.useContext)(o),e=t.state,c=t.getCats,a=t.setFetching,i=Object(n.useContext)(u).setFavoriteCat,r=Object(n.useState)(1),j=Object(s.a)(r,2),f=j[0],b=j[1];Object(n.useEffect)((function(){e.fetching&&(c(f),b((function(t){return t+1})))}),[e.fetching]),Object(n.useEffect)((function(){return document.addEventListener("scroll",d),function(){document.removeEventListener("scroll",d)}}),[e.fetching]);var d=function(t){t.target.documentElement.scrollHeight-(t.target.documentElement.scrollTop+window.innerHeight)<100&&a(!0)};return Object(l.jsx)("div",{className:"container",children:Object(l.jsx)("div",{className:"gallery",children:e.cats.map((function(t){return Object(l.jsxs)("div",{className:"gallery__item",children:[Object(l.jsx)("div",{className:"hover-block"}),Object(l.jsx)("img",{className:"gallery__img",src:t.url,alt:""}),Object(l.jsx)("button",{className:"gallery__btn",onClick:function(){return i(t.id)},title:"\u0414\u043e\u0431\u0430\u0432\u0438\u0442\u044c \u043a\u043e\u0442\u0438\u043a\u0430"})]},t.id)}))})})},f=c(2),b=c(12),d=function(){return Object(l.jsx)(l.Fragment,{children:Object(l.jsx)("nav",{className:"navbar",children:Object(l.jsx)("div",{className:"container",children:Object(l.jsxs)("ul",{className:"navbar__items",children:[Object(l.jsx)("li",{className:"navbar__item",children:Object(l.jsx)(b.b,{className:"navbar__link",exact:!0,to:"/",children:"\u0412\u0441\u0435 \u043a\u043e\u0442\u0438\u043a\u0438"})}),Object(l.jsx)("li",{className:"navbar__item",children:Object(l.jsx)(b.b,{className:"navbar__link ",to:"/favorite",children:"\u041b\u044e\u0431\u0438\u043c\u044b\u0435 \u043a\u043e\u0442\u0438\u043a\u0438"})})]})})})})},O=function(){var t=Object(n.useContext)(u),e=t.state,c=t.getFavoriteCats,a=t.setFetching,i=t.deleteCat,r=Object(n.useState)(0),o=Object(s.a)(r,2),j=o[0],f=o[1];Object(n.useEffect)((function(){e.fetching&&(c(j),f((function(t){return t+1})))}),[e.fetching]),Object(n.useEffect)((function(){return document.addEventListener("scroll",b),function(){document.removeEventListener("scroll",b)}}),[e.fetching]);var b=function(t){t.target.documentElement.scrollHeight-(t.target.documentElement.scrollTop+window.innerHeight)<100&&e.favoriteCats.length<e.totalCount&&a(!0)};return Object(l.jsx)("div",{className:"container",children:Object(l.jsx)("div",{className:"gallery",children:e.favoriteCats.map((function(t){return Object(l.jsxs)("div",{className:"gallery__item",children:[Object(l.jsx)("div",{className:"hover-block"}),Object(l.jsx)("img",{className:"gallery__img",src:t.image.url,alt:""}),Object(l.jsx)("button",{onClick:function(){return i(t.id)},className:"gallery__btn active",title:"\u0423\u0431\u0440\u0430\u0442\u044c \u043a\u043e\u0442\u0438\u043a\u0430"})]},t.id)}))})})},h=c(11),v=c(4),g="GET_CATS",m="FETCHING",x="GET_FAVORITE_CATS",C="SET_TOTAL_COUNT",p="DELETE_CAT",_="SET_FAVORITE_CAT",E=function(t,e){switch(e.type){case g:return Object(v.a)(Object(v.a)({},t),{},{cats:[].concat(Object(h.a)(t.cats),Object(h.a)(e.cats))});case m:return Object(v.a)(Object(v.a)({},t),{},{fetching:e.fetching});default:return t}},N=c(31).create({baseURL:"https://api.thecatapi.com/v1/",headers:{"x-api-key":"03488ee6-4bf2-4798-9586-f45dfffe60ba"}}),y=function(t){return N.get("images/search?limit=15&page=".concat(t))},T=function(t){return N.get("favourites/?limit=15&page=".concat(t))},F=function(){return N.get("favourites/")},k=function(t){return N.post("favourites",{image_id:t})},w=function(t){return N.delete("favourites/".concat(t))},L=function(t){var e=Object(n.useReducer)(E,{cats:[],fetching:!0}),c=Object(s.a)(e,2),a=c[0],i=c[1],r=function(t){return{type:m,fetching:t}};return Object(l.jsx)(o.Provider,{value:{state:a,getCats:function(){y().then((function(t){var e;i((e=t.data,{type:g,cats:e}))})).finally((function(){i(r(!1))}))},setFetching:function(t){i(r(t))}},children:t.children})},S=function(t,e){switch(e.type){case x:return Object(v.a)(Object(v.a)({},t),{},{favoriteCats:[].concat(Object(h.a)(t.favoriteCats),Object(h.a)(e.cats))});case m:return Object(v.a)(Object(v.a)({},t),{},{fetching:e.fetching});case C:return Object(v.a)(Object(v.a)({},t),{},{totalCount:e.count});case _:return Object(v.a)(Object(v.a)({},t),{},{favoriteCats:[].concat(Object(h.a)(t.favoriteCats),[e.cat])});case p:return Object(v.a)(Object(v.a)({},t),{},{favoriteCats:t.favoriteCats.filter((function(t){return t.id!==e.id}))});default:return t}},A=function(t){var e=Object(n.useReducer)(S,{favoriteCats:[],fetching:!0,totalCount:0}),c=Object(s.a)(e,2),a=c[0],i=c[1],r=function(t){return{type:m,fetching:t}};return Object(l.jsx)(u.Provider,{value:{state:a,getFavoriteCats:function(t){T(t).then((function(t){var e,c;i((e=t.data,{type:x,cats:e})),i((c=t.headers["pagination-count"],{type:C,count:c}))})).finally((function(){i(r(!1))}))},setFetching:function(t){i(r(t))},setFavoriteCat:function(t){k(t),setTimeout((function(){F().then((function(t){var e;i((e=t.data[t.data.length-1],{type:_,cat:e}))})).catch((function(t){console.log(t)}))}),500)},deleteCat:function(t){w(t),i(function(t){return{type:p,id:t}}(t))}},children:t.children})};var H=function(){return Object(l.jsx)("div",{className:"wrapper",children:Object(l.jsx)(A,{children:Object(l.jsxs)(L,{children:[Object(l.jsx)(d,{}),Object(l.jsx)("div",{children:Object(l.jsxs)(f.c,{children:[Object(l.jsx)(f.a,{path:"/",exact:!0,component:j}),Object(l.jsx)(f.a,{path:"/favorite",exact:!0,component:O})]})})]})})})},I=function(t){t&&t instanceof Function&&c.e(3).then(c.bind(null,63)).then((function(e){var c=e.getCLS,n=e.getFID,a=e.getFCP,i=e.getLCP,r=e.getTTFB;c(t),n(t),a(t),i(t),r(t)}))};r.a.render(Object(l.jsx)(a.a.StrictMode,{children:Object(l.jsx)(b.a,{children:Object(l.jsx)(H,{})})}),document.getElementById("root")),I()}},[[62,1,2]]]);
//# sourceMappingURL=main.f5c4b198.chunk.js.map